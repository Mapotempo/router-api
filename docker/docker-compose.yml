version: '2'
services:
    wrapper:
      build:
        context: ..
        dockerfile: docker/Dockerfile
      image: mapotempo/router-wrapper:latest
      ports:
        - "80:80"
      volumes:
        - ./production.rb:/srv/app/config/environments/production.rb
      links:
        - redis-cache
        - otp

    otp:
      build:
        context: otp
        args:
          OTP_VERSION: 1.0.0
      image: mapotempo/otp-server:1.0.0
      volumes:
        - /srv/otp/data:/srv/otp/data

    dom-car:
      build:
        context: osrm/server
        args:
          OSRM_VERSION: 5.5.2
      image: mapotempo/osrm-server:latest
      environment:
        REGION: dom
        PROFILE: car
      volumes:
        - /srv/osrm/data:/srv/osrm/data
        - /dev/log:/dev/log

    redis-cache:
        image: redis:alpine
  
